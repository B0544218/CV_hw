# 開發環境 Colab
## 電腦視覺馬拉松 學習報告
### 作者：鄭凱元
### 一、背景及動機
 	近年來不管是自駕車或是工業上的瑕疵檢測或是車牌辨識，這些都是電腦視覺領域的熱門應用，在自駕車的應用中電腦的任務不只是分辨道路上有哪些物件的類別，同時也要訓練電腦藉由追蹤這些物件來了解路況；而網路遊戲中雖然遊戲的功能豐富，但卻很少見到讓電腦代替玩家自動玩遊戲的功能，因此為了讓電腦可以懂得遊戲中的物件，因此以射擊遊戲為例，訓練電腦能夠識別物件類別與位置。
### 二、資料來源
 	資料來源是來自一個網頁上的射擊小遊戲，為甚麼選擇遊戲的原因如下，第一個主因是以資料去得的方便性來探討，在遊戲中可以藉由重複地挑戰遊戲來得到新的一批資料，並且遊戲中的物件位置都是隨機的，因此不用擔心數據不夠或重複性高的問題，第二個原因是物件移動軌跡變化多，考慮到現實生活中物件彼此間有重疊或遮擋的情形，因此選擇了一款動作模式上相對豐富的遊戲來作研究，並使用標記軟體來取得所需的座標和類別，來實現物件偵測。
### 三、實驗方法
（一）data collection
 	做監督式學習前，需要有一定量的label數據，因此以射擊飛彈遊戲為獲取圖片來源，並利用了LabelImage軟體，來人工取得各個bounding box下的物件類別與座標。接著再將軟體的輸出格式轉成yolo training model允許的格式。 
（二）with yolov3 training and predict
	為了讓預測能夠更加準確，因此選用了yolov3的darknet-53 module進行實作(經過實驗後覺得darknet-53的及時偵測時間符合實際預期，因此不使用其他模型如tiny-yolo)，由於遊戲中的飛彈會旋轉，所以另外修改了Data Augumentation的參數(增加圖形在角度上的變化)；而為了加速收斂速度，以遊戲中的物件大小為主，首先把anchor box的寬高做了一些調整，並使用官方提供的權重參數進行遷移學習(不凍結layer直接訓練)，由於yolov3利用了Residual Network來增加網路層數，雖然因為參數較多比yolov1還要費時但卻更加精準。。
	

### 四、心得
 	參加電腦視覺馬拉松除了讓我對機器學習有近一步的認識外，從中也了解到許多不同network的結構；在寫這篇報告的實驗中。意外發現yolov3在做資料增強時的侷限性，實驗中有物件因為背景顏色因素而被沒被偵測出來，雖然事後在yolov3的模型中調整了參數hue並重新訓練，但實驗結果沒有差多少，因此，如果想要增加圖片上的雜訊的話，在進行訓練前得先用外部(非yolo提供的)Data Augumentation來增加雜訊來增加資料的多樣性。



### 五、參考文獻
遊戲來源 : http://flashghetto.com/games/mad_mutually_assured_destruction
Joseph Redmon and Ali Farhadi. YOLOv3: An incremental improvement. arXiv preprint arXiv:1804.02767, 2018.
